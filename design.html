<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HFT Architecture - Institutional Grade</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --neon-green: #10b981;
            --neon-blue: #3b82f6;
            --neon-purple: #8b5cf6;
            --neon-yellow: #eab308;
            --neon-red: #ef4444;
            --neon-orange: #f97316;
            --glass-bg: rgba(15, 23, 42, 0.7);
            --glass-border: rgba(255, 255, 255, 0.08);
        }

        body {
            font-family: 'Inter', sans-serif;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* --- ANIMACIONES --- */
        @keyframes data-stream {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: 40px 0;
            }
        }

        .flow-fast {
            background: repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(234, 179, 8, 0.4) 10px, rgba(234, 179, 8, 0.4) 20px);
            background-size: 40px 100%;
            animation: data-stream 0.5s linear infinite;
        }

        @keyframes data-stream-rev {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: -40px 0;
            }
        }

        .flow-med-rev {
            background: repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(59, 130, 246, 0.4) 10px, rgba(59, 130, 246, 0.4) 20px);
            background-size: 40px 100%;
            animation: data-stream-rev 1s linear infinite;
        }

        .flow-shadow {
            background: repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(148, 163, 184, 0.2) 10px, rgba(148, 163, 184, 0.2) 20px);
            background-size: 40px 100%;
            animation: data-stream 1.5s linear infinite;
        }

        @keyframes pulse-red {
            0% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }

        .animate-pulse-red {
            animation: pulse-red 2s infinite;
        }

        /* --- ESTILOS --- */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }

        .glow-hover:hover {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
        }

        .glow-danger:hover {
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
            border-color: rgba(239, 68, 68, 0.6);
        }

        .bg-grid-tech {
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        /* Conectores */
        .connector-line {
            position: absolute;
            z-index: -1;
            border: 1px dashed rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #020617;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
        }

        .text-xxs {
            font-size: 0.65rem;
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-200 h-screen flex flex-col overflow-hidden selection:bg-cyan-500/30">

    <!-- TOP BAR -->
    <header class="h-14 border-b border-slate-800 bg-slate-950 flex items-center justify-between px-6 z-50 shrink-0">
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <i data-lucide="shield-check" class="text-orange-500 w-5 h-5"></i>
                <span class="font-bold tracking-tight text-white">QUANTUM<span
                        class="text-orange-500">GUARD</span></span>
            </div>
            <div class="h-4 w-px bg-slate-800"></div>
            <div class="flex items-center gap-2 text-xs font-mono text-slate-400">
                <span class="text-emerald-500 animate-pulse">●</span> SECURE FABRIC v2.0
            </div>
        </div>

        <div class="flex items-center gap-6 font-mono text-xs">
            <div class="flex flex-col items-end leading-none gap-1">
                <span class="text-slate-500">KILL SWITCH</span>
                <span class="text-emerald-400">ARMED</span>
            </div>
            <div class="flex flex-col items-end leading-none gap-1">
                <span class="text-slate-500">CLOCK DRIFT</span>
                <span class="text-indigo-400">±2µs (PTP)</span>
            </div>
            <div class="flex flex-col items-end leading-none gap-1">
                <span class="text-slate-500">VAULT STATUS</span>
                <span class="text-white">LOCKED</span>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div class="flex flex-1 overflow-hidden relative">

        <div class="flex-1 bg-slate-950 bg-grid-tech relative overflow-hidden flex items-center justify-center">
            <!-- Background Gradient -->
            <div
                class="absolute inset-0 bg-[radial-gradient(circle_at_center,transparent_0%,rgba(2,6,23,0.95)_100%)] pointer-events-none">
            </div>

            <!-- LAYOUT CONTAINER -->
            <div class="relative w-full max-w-[1600px] h-full p-6 grid grid-cols-12 gap-6 overflow-y-auto">

                <!-- === COL 1-2: OPS & SECURITY LAYER === -->
                <div class="col-span-2 flex flex-col gap-4 border-r border-slate-800/50 pr-4">
                    <div class="text-xs font-mono text-slate-500 uppercase tracking-widest mb-2">Infra & Sec</div>

                    <!-- Hashicorp Vault -->
                    <div onclick="inspect('vault')" class="glass-panel p-4 rounded-xl cursor-pointer glow-hover group">
                        <div class="flex items-center gap-3 mb-2">
                            <i data-lucide="lock"
                                class="w-5 h-5 text-slate-400 group-hover:text-white transition-colors"></i>
                            <h3 class="font-bold text-slate-200 text-sm">Vault</h3>
                        </div>
                        <p class="text-xxs text-slate-500">Secrets Management</p>
                        <div class="mt-2 text-xxs font-mono text-emerald-500">● Rotation: Active</div>
                    </div>

                    <!-- Observability Stack -->
                    <div onclick="inspect('ops')"
                        class="glass-panel p-4 rounded-xl cursor-pointer glow-hover group flex-1">
                        <div class="flex items-center gap-3 mb-4">
                            <i data-lucide="eye" class="w-5 h-5 text-orange-400"></i>
                            <h3 class="font-bold text-slate-200 text-sm">Observability</h3>
                        </div>

                        <div class="space-y-3">
                            <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                <div class="flex justify-between items-center text-xxs text-slate-400 mb-1">
                                    <span>Prometheus</span>
                                    <span class="text-orange-400">98k ops</span>
                                </div>
                                <div class="w-full h-1 bg-slate-800 rounded-full">
                                    <div class="h-full w-3/4 bg-orange-500"></div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                <div class="flex justify-between items-center text-xxs text-slate-400 mb-1">
                                    <span>Loki (Logs)</span>
                                    <span class="text-blue-400">1.2GB/s</span>
                                </div>
                                <div class="w-full h-1 bg-slate-800 rounded-full">
                                    <div class="h-full w-1/2 bg-blue-500"></div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                <div class="flex justify-between items-center text-xxs text-slate-400 mb-1">
                                    <span>PTP Time</span>
                                    <span class="text-emerald-400">Sync</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- === COL 3-10: TRADING CORE === -->
                <div class="col-span-8 grid grid-cols-12 gap-6 relative">

                    <!-- K8S Box -->
                    <div
                        class="absolute -inset-4 border border-dashed border-slate-700/40 rounded-3xl pointer-events-none">
                    </div>
                    <div class="absolute -top-7 left-0 text-xs font-mono text-slate-500 flex items-center gap-2">
                        <i data-lucide="box" class="w-3 h-3"></i> K8S: PRODUCTION NAMESPACE
                    </div>

                    <!-- LEFT: EXECUTION & WATCHDOG -->
                    <div class="col-span-3 flex flex-col gap-4 relative">

                        <!-- KILL SWITCH -->
                        <div onclick="inspect('watchdog')"
                            class="absolute -top-4 -right-4 z-20 bg-slate-900 border border-red-500/50 p-2 rounded-lg cursor-pointer animate-pulse-red hover:bg-red-900/20 transition-colors shadow-lg">
                            <div class="flex items-center gap-2">
                                <i data-lucide="skull" class="w-4 h-4 text-red-500"></i>
                                <span class="text-xs font-bold text-red-500">KILL SWITCH</span>
                            </div>
                        </div>

                        <!-- MT5 Pod -->
                        <div onclick="inspect('mt5')"
                            class="glass-panel p-5 rounded-xl cursor-pointer glow-hover h-full flex flex-col justify-between">
                            <div>
                                <div class="flex justify-between mb-2">
                                    <i data-lucide="monitor-play" class="w-6 h-6 text-emerald-400"></i>
                                    <span
                                        class="text-xxs font-mono bg-emerald-500/10 text-emerald-400 px-1 rounded">LIVE</span>
                                </div>
                                <h3 class="font-bold text-white text-sm">MT5 Engine</h3>
                                <p class="text-xxs text-slate-400">Execution Proxy</p>
                            </div>
                            <!-- Bridge EA -->
                            <div class="mt-4 bg-slate-900/80 border border-slate-700 p-2 rounded relative">
                                <div class="absolute left-0 top-0 bottom-0 w-1 bg-emerald-500"></div>
                                <span class="text-xs font-bold text-slate-200 ml-2">Bridge EA</span>
                            </div>
                        </div>
                    </div>

                    <!-- CENTER: BUS & SHADOW LAYER -->
                    <div class="col-span-5 flex flex-col gap-2 relative">

                        <!-- LIVE LAYER -->
                        <div class="bg-slate-900/30 p-2 rounded-xl border border-slate-800/50 mb-2">
                            <div class="text-xxs font-mono text-center text-slate-600 mb-1">LIVE ZMQ BUS</div>
                            <!-- Ticks -->
                            <div onclick="inspect('zmq')"
                                class="h-8 bg-slate-900 border border-yellow-500/20 rounded mb-2 relative overflow-hidden flex items-center px-2 cursor-pointer">
                                <div class="absolute inset-0 flow-fast opacity-10"></div>
                                <span class="text-xxs font-bold text-yellow-500 z-10">PUB: TICKS</span>
                            </div>
                            <!-- Cmds -->
                            <div onclick="inspect('zmq')"
                                class="h-8 bg-slate-900 border border-blue-500/20 rounded relative overflow-hidden flex items-center justify-end px-2 cursor-pointer">
                                <div class="absolute inset-0 flow-med-rev opacity-10"></div>
                                <span class="text-xxs font-bold text-blue-500 z-10">PULL: CMDS</span>
                            </div>
                        </div>

                        <!-- SHADOW LAYER -->
                        <div class="bg-slate-900/20 p-2 rounded-xl border border-dashed border-slate-700/50 relative">
                            <div class="absolute inset-0 bg-slate-950/50 z-10 pointer-events-none"></div>
                            <!-- Dim effect -->
                            <div class="text-xxs font-mono text-center text-slate-600 mb-1 z-20 relative">SHADOW / SIM
                                BUS</div>

                            <!-- Shadow Ticks (Copy) -->
                            <div
                                class="h-6 bg-slate-900 border border-slate-700 rounded mb-2 relative overflow-hidden flex items-center px-2 opacity-50">
                                <div class="absolute inset-0 flow-shadow"></div>
                                <span class="text-xxs font-mono text-slate-400 z-10">PUB: MIRROR</span>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT: ORCHESTRATION -->
                    <div class="col-span-4 flex flex-col gap-4">

                        <!-- LIVE Orchestrator -->
                        <div onclick="inspect('orchestrator')"
                            class="glass-panel p-4 rounded-xl cursor-pointer glow-hover relative overflow-hidden">
                            <div class="flex items-center gap-3 mb-2">
                                <i data-lucide="brain-circuit" class="w-5 h-5 text-blue-400"></i>
                                <div>
                                    <h3 class="font-bold text-white text-sm">Orchestrator</h3>
                                    <p class="text-xxs text-blue-400 font-mono">PRIMARY</p>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <span
                                    class="text-xxs bg-blue-500/10 text-blue-400 px-1 rounded border border-blue-500/20">Risk
                                    Check</span>
                                <span
                                    class="text-xxs bg-blue-500/10 text-blue-400 px-1 rounded border border-blue-500/20">Router</span>
                            </div>
                        </div>

                        <!-- SHADOW Orchestrator -->
                        <div onclick="inspect('shadow')"
                            class="glass-panel p-3 rounded-xl cursor-pointer hover:border-slate-500 border-dashed border-slate-700 relative opacity-70 hover:opacity-100 transition-opacity">
                            <div
                                class="absolute -right-2 -top-2 bg-slate-800 text-slate-400 text-[10px] px-2 py-0.5 rounded border border-slate-600">
                                CANARY v2</div>
                            <div class="flex items-center gap-3">
                                <i data-lucide="ghost" class="w-5 h-5 text-slate-400"></i>
                                <div>
                                    <h3 class="font-bold text-slate-300 text-sm">Shadow Orch</h3>
                                    <p class="text-xxs text-slate-500 font-mono">Simulated Exec</p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- BOTTOM: PERSISTENCE -->
                    <div class="col-span-12 flex gap-4 mt-2 pt-4 border-t border-dashed border-slate-800">
                        <div onclick="inspect('redis')"
                            class="glass-panel p-3 rounded-lg flex-1 flex items-center gap-3 cursor-pointer hover:bg-white/5">
                            <i data-lucide="database-zap" class="text-red-500 w-5 h-5"></i>
                            <div>
                                <h4 class="text-xs font-bold text-red-100">Redis</h4>
                                <p class="text-xxs text-slate-400">Hot State</p>
                            </div>
                        </div>
                        <div onclick="inspect('timescale')"
                            class="glass-panel p-3 rounded-lg flex-1 flex items-center gap-3 cursor-pointer hover:bg-white/5">
                            <i data-lucide="database" class="text-cyan-500 w-5 h-5"></i>
                            <div>
                                <h4 class="text-xs font-bold text-cyan-100">PostgreSQL</h4>
                                <p class="text-xxs text-slate-400">Historical</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- === COL 11-12: TRAINING (MLOps) === -->
                <div class="col-span-2 flex flex-col gap-4 border-l border-slate-800/50 pl-4 relative">
                    <div class="text-xs font-mono text-pink-500/70 uppercase tracking-widest mb-2">Offline Ops</div>

                    <div onclick="inspect('training')"
                        class="glass-panel p-4 rounded-xl cursor-pointer glow-hover relative overflow-hidden group h-32">
                        <div class="absolute inset-0 bg-pink-500/5 group-hover:bg-pink-500/10 transition-colors"></div>
                        <div class="flex items-center gap-3 mb-2 relative z-10">
                            <i data-lucide="layers" class="w-5 h-5 text-pink-500"></i>
                            <h3 class="font-bold text-pink-100 text-sm">GPU Farm</h3>
                        </div>
                        <p class="text-xxs text-pink-400 relative z-10">Training Cluster</p>
                        <div class="absolute bottom-2 right-2 text-xxs font-mono text-slate-500">A100 x 8</div>
                    </div>

                    <div class="flex justify-center"><i data-lucide="arrow-down" class="w-4 h-4 text-slate-700"></i>
                    </div>

                    <div onclick="inspect('registry')" class="glass-panel p-4 rounded-xl cursor-pointer glow-hover">
                        <div class="flex items-center gap-3 mb-2">
                            <i data-lucide="package" class="w-5 h-5 text-purple-500"></i>
                            <h3 class="font-bold text-purple-100 text-sm">Registry</h3>
                        </div>
                        <p class="text-xxs text-slate-400">Model Artifacts</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- INSPECTOR PANEL -->
        <div id="inspector" class="w-80 bg-slate-900 border-l border-slate-800 flex flex-col z-20 shadow-2xl">
            <div id="inspector-empty"
                class="h-full flex flex-col items-center justify-center text-slate-600 p-8 text-center">
                <i data-lucide="scan-line" class="w-12 h-12 mb-4 opacity-20"></i>
                <p class="text-sm">System Inspector Ready</p>
            </div>
            <div id="inspector-content" class="hidden flex-col h-full">
                <div class="p-6 border-b border-slate-800 bg-slate-900/50">
                    <div class="flex items-center gap-3 mb-2">
                        <div id="ins-icon" class="p-2 rounded-lg bg-slate-800 border border-slate-700 text-cyan-400">
                        </div>
                        <h2 id="ins-title" class="text-lg font-bold text-white leading-tight font-mono"></h2>
                    </div>
                    <div id="ins-tags" class="flex flex-wrap gap-2 mt-3"></div>
                </div>
                <div class="flex-1 overflow-y-auto p-6 space-y-6">
                    <p id="ins-desc" class="text-sm text-slate-400 leading-relaxed"></p>
                    <div>
                        <h4 class="text-xs font-bold text-slate-500 uppercase mb-3 flex items-center gap-2"><i
                                data-lucide="settings" class="w-3 h-3"></i> Specs</h4>
                        <ul id="ins-specs" class="space-y-2"></ul>
                    </div>
                    <div class="bg-slate-950 rounded-lg border border-slate-800 p-3 font-mono text-xxs overflow-hidden">
                        <div class="flex justify-between text-slate-600 mb-2 pb-2 border-b border-slate-900"><span>LIVE
                                LOGS</span><span class="animate-pulse text-emerald-500">●</span></div>
                        <div id="ins-logs" class="space-y-1 text-slate-400 h-24 overflow-hidden relative"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- JAVASCRIPT -->
    <script>
        lucide.createIcons();

        const db = {
            mt5: {
                title: "MT5 Execution Pod",
                icon: "monitor-play",
                desc: "Contenedor Windows/Wine optimizado. Actúa como proxy de ejecución 'tonto'.",
                tags: ["PROD", "CRITICAL"],
                specs: ["OS: Alpine+Wine", "Isolation: High", "PTP Sync: Enabled"],
                logs: ["[INFO] Heartbeat OK", "[INFO] Tick received 1.0523", "[DEBUG] ZMQ Buffer 0%"]
            },
            watchdog: {
                title: "Kill Switch (Watchdog)",
                icon: "skull",
                desc: "Proceso guardián independiente (Go/Rust). Monitorea PnL global y exposición. Puede matar conexiones o cerrar MT5 instantáneamente si se violan los límites de riesgo.",
                tags: ["SAFETY", "RUST", "L0"],
                specs: ["Latency: <1ms", "Access: Root", "Trigger: PnL < -5%"],
                logs: ["[INFO] Monitoring PnL...", "[INFO] Exposure check: SAFE", "[DEBUG] Connection to MT5: OK"]
            },
            ops: {
                title: "Observability Stack",
                icon: "eye",
                desc: "Infraestructura de monitoreo centralizada. Prometheus recolecta métricas de latencia y sistema. Grafana visualiza. Loki agrega logs.",
                tags: ["OPS", "GRAFANA"],
                specs: ["Prometheus: Scrape 1s", "Loki: Log Aggregation", "Alerts: PagerDuty"],
                logs: ["[INFO] Scraped 120 pods", "[WARN] Latency spike detected", "[INFO] Dashboard updated"]
            },
            vault: {
                title: "HashiCorp Vault",
                icon: "lock",
                desc: "Gestión centralizada de secretos. Inyecta credenciales de broker y claves de API en tiempo de ejecución. Nada hardcodeado.",
                tags: ["SECURITY", "SECRETS"],
                specs: ["Encryption: AES-256", "Auth: K8s ServiceAccount", "Audit: Enabled"],
                logs: ["[INFO] MT5 Creds leased", "[AUDIT] Secret access by Pod-1", "[INFO] Token rotated"]
            },
            shadow: {
                title: "Shadow Orchestrator",
                icon: "ghost",
                desc: "Entorno de ejecución paralelo (Canary). Recibe datos reales pero envía órdenes a un simulador de mercado interno. Usado para validar modelos v+1.",
                tags: ["TEST", "CANARY"],
                specs: ["Input: Real Data Mirror", "Output: Market Sim", "Logic: New Model Candidate"],
                logs: ["[INFO] Shadow Trade BUY", "[INFO] Sim Fill: 1.0524", "[INFO] PnL Diff: +0.01%"]
            },
            zmq: {
                title: "ZeroMQ Fabric",
                icon: "network",
                desc: "Bus de mensajes IPC de baja latencia.",
                tags: ["IPC", "TCP"],
                specs: ["PUB/SUB: Data", "PUSH/PULL: Cmds"],
                logs: ["PUB: 50 ticks broadcast", "PULL: 1 Cmd received"]
            },
            orchestrator: {
                title: "Live Orchestrator",
                icon: "brain-circuit",
                desc: "Gestor de riesgo y ejecución principal.",
                tags: ["PYTHON", "ASYNC"],
                specs: ["Risk Check: <10us", "Router: Active"],
                logs: ["Risk Check PASS", "Order Routed"]
            },
            redis: { title: "Redis", icon: "database-zap", desc: "Hot Data Cache", tags: ["CACHE"], specs: ["AOF: On"], logs: ["SET OK", "GET OK"] },
            timescale: { title: "Postgres", icon: "database", desc: "Historical DB", tags: ["SQL"], specs: ["TimescaleDB"], logs: ["INSERT OK"] },
            training: { title: "GPU Cluster", icon: "layers", desc: "Model Training", tags: ["GPU"], specs: ["A100"], logs: ["Epoch 50"] },
            registry: { title: "Registry", icon: "package", desc: "Artifact Store", tags: ["S3"], specs: ["Versioned"], logs: ["New Model"] }
        };

        function inspect(key) {
            const data = db[key];
            if (!data) return;
            document.getElementById('inspector-empty').classList.add('hidden');
            document.getElementById('inspector-content').classList.remove('hidden');
            document.getElementById('inspector-content').classList.add('flex');

            document.getElementById('ins-title').innerText = data.title;
            document.getElementById('ins-desc').innerText = data.desc;
            document.getElementById('ins-icon').innerHTML = `<i data-lucide="${data.icon}" class="w-6 h-6"></i>`;
            document.getElementById('ins-tags').innerHTML = data.tags.map(t => `<span class="text-xxs font-bold bg-slate-800 text-slate-300 px-2 py-1 rounded border border-slate-700">${t}</span>`).join('');
            document.getElementById('ins-specs').innerHTML = data.specs.map(s => `<li class="flex items-center gap-3 text-xs text-slate-300 bg-slate-950/50 p-2 rounded border border-slate-800"><span class="w-1.5 h-1.5 rounded-full bg-cyan-500"></span> ${s}</li>`).join('');
            document.getElementById('ins-logs').innerHTML = data.logs.map(l => `<div class="truncate"><span class="text-slate-600">[${new Date().toLocaleTimeString()}]</span> ${l}</div>`).join('');
            lucide.createIcons();
        }
    </script>
</body>

</html>